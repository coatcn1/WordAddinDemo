<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>文档规范性检查</title><script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script><link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/><link href="d8108e96be0210d8bc62.css" rel="stylesheet"/><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body class="ms-font-m ms-Fabric"><div id="content-main"><div class="padding"><div class="section" style="margin:10px;display:flex;flex-direction:column;height:100%"><div style="flex-grow:1;display:flex;flex-direction:column"><div style="margin-bottom:10px;display:flex;align-items:center;gap:10px"><input type="file" id="file-input" accept=".txt" style="display:none"/> <button id="load-rules" class="ms-Button" style="flex:0 0 calc(100% - 42px)"><span class="ms-Button-label">载入规则</span></button> <button id="settings-button" class="ms-Button" style="width:32px;min-width:32px;padding:0;height:32px"><span class="ms-Button-label"><i class="fas fa-cog"></i></span></button></div><textarea id="rules-input" class="rules-textarea" placeholder='在此处粘贴规则或点击"载入规则"按钮加载规则文件' spellcheck="false" style="width:100%;min-height:200px;margin:10px 0;padding:8px;border:1px solid #ccc;border-radius:4px;resize:vertical"></textarea><p style="font-size:12px;color:#666;margin-top:5px">提示：您可以在文档中选择要检查的内容，如果未选择，则默认检查全文。</p><div id="status" class="status-message" style="margin-bottom:10px;min-height:20px"></div></div><div style="border-top:1px solid #e0e0e0;padding-top:10px"><div class="button-row"><button id="check-button" class="ms-Button ms-Button--primary"><span class="button-content"><span class="button-text">开始检查</span> <span class="loading-dots"></span></span></button> <label class="debug-checkbox"><input type="checkbox" id="show-debug" style="margin:0"/> <span>显示调试信息</span></label></div><div id="debug-container" style="display:none;margin-top:10px"><textarea id="debug-textarea" style="width:100%;height:200px;padding:8px;font-family:monospace;font-size:12px;line-height:1.4;border:1px solid #ccc;border-radius:4px;background-color:#f5f5f5;resize:vertical" readonly="readonly"></textarea></div></div></div></div></div><div id="settings-panel" style="display:none;position:absolute;top:50px;left:10px;right:10px;background:#fff;border:1px solid #ccc;padding:15px;box-shadow:0 2px 4px rgba(0,0,0,.2);border-radius:4px"><div style="margin-bottom:15px"><label for="apikey" style="display:block;margin-bottom:5px">API Key:</label> <input id="apikey" style="width:100%;padding:5px;border:1px solid #ccc;border-radius:4px"/></div><div style="margin-bottom:15px"><label for="chunk-size" style="display:block;margin-bottom:5px">每个片段的字符数（200-2000）:</label> <input type="number" id="chunk-size" min="200" max="2000" value="800" style="width:100%;padding:5px;border:1px solid #ccc;border-radius:4px"/></div><div style="display:flex;justify-content:flex-end;gap:10px"><button id="cancel-settings" class="ms-Button"><span class="ms-Button-label">取消</span></button> <button id="save-settings" class="ms-Button ms-Button--primary"><span class="ms-Button-label">保存</span></button></div></div></body></html>